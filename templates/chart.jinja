<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Bar Chart</title>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<style>
			body,
			html {
				height: 100%;
			}
			body {
				margin: 60px;
				font-family: sans-serif;
				color: rgba(0,0,0,.7);
				font-size: 16px;
				{# font-weight: 300; #}
			}
			pre {
				font-size: 13px;
				white-space: break-spaces;
				line-height: 1.5;
				color: darkblue;
				background: #fafafa;
				padding: 20px;
				border-radius: 2px;
				border: solid 1px rgba(0,0,0,.1);
			}
			details {
				margin-top: 50px;
				cursor: pointer;
			}
			details h3 {
				display: inline-block;
				user-select: none;
			}
			details h3:hover {
				color: darkblue;
			}
			#the-chart-wrap {
				width: 100%;
				height: 600px;
				margin-top: 100px;
				/* max-width: 800px; */
			}
			#the-chart {
				border: solid 1px rgba(0, 0, 0, 0.1);
				box-shadow: 0 0 100px rgba(0, 0, 0, 0.1);
			}
		</style>
	</head>
	<body>
		{{ ('<h1>' + title + '</h1>') | safe if title else '' }}
		{{ ('<h2>' + subtitle + '</h2>') | safe if subtitle else '' }}
		{{ ('<p>' + body + '</p>') | safe if body else '' }}
		
		<small>
			Screenshot mode: {{ screenshot }}<br />
			Width: {{ width }}<br />
			Height: {{ height }}<br />
		</small>
		
		<details>
			<summary><h3>Chart Data</h3></summary>
			<pre>{{ chart_data | tojson }}</pre>
		</details>

		<div id="the-chart-wrap" style="width: {{ width | default(800) }}px; height: {{ height | default(800) }}px">
			<canvas
				id="the-chart"
				class="{{ 'screenshot' if screenshot else '' }}"
			></canvas>
		</div>

		<script>
			const ctx = document.getElementById("the-chart").getContext("2d")

			const theChart = new Chart(ctx, {
				type: "bar",
				data: {
					labels: {{ chart_data.labels | tojson }},
					datasets: [
						{
							label: "{{ chart_data.dataset1.label }}",
							data: {{ chart_data.dataset1.data | tojson }},
							backgroundColor: "{{ chart_data.dataset1.backgroundColor | default('rgba(255, 99, 132, 0.5)') }}",
							borderColor: "{{ chart_data.dataset1.borderColor | default('rgba(255, 99, 132, 1)') }}",
							borderWidth: {{ chart_data.dataset1.borderWidth | default(1) }},
						},
						{
							label: "{{ chart_data.dataset2.label }}",
							data: {{ chart_data.dataset2.data | tojson }},
							backgroundColor: "{{ chart_data.dataset2.backgroundColor | default('rgba(54, 162, 235, 0.5)') }}",
							borderColor: "{{ chart_data.dataset2.borderColor | default('rgba(54, 162, 235, 1)') }}",
							borderWidth: {{ chart_data.dataset2.borderWidth | default(1) }},
						},
					],
				},
				options: {
					animation: false,
					responsive: true,
					maintainAspectRatio: false,
					layout: {
						// padding: 40,
						padding: {
							left: 40,
							right: 40,
							top: 30,
							bottom: 30,
						},
					},
					scales: {
						y: {
							beginAtZero: true,
						},
					},
				},
			})
		</script>
	</body>
</html>
